<section class="spendings-history">
    <section class="d-flex justify-content-between">
        <mat-form-field  appearance="outline">
            <mat-label>{{ displayValue }}</mat-label>
            <mat-select #selectRef [(value)]="selectedCategories">
                <mat-option (click)="$event.stopPropagation()">
                    <mat-checkbox
                    [checked]="isAllCategoriesChecked"
                    (click)="$event.stopPropagation()"
                    (change)="toggleAllCategories()"
                    >
                    All categories
                    </mat-checkbox>
                </mat-option>
                @for(category of categories; track category) {
                    <mat-option [value]="category" (click)="$event.stopPropagation()">
                        <mat-checkbox 
                            [checked]="selectedCategories.includes(category)"
                            (change)="onCategoryChange(category, $event.checked)"
                            >
                            {{ category.title }}
                        </mat-checkbox>
                    </mat-option>
                }
                <!-- <mat-option class="close-button-option"> -->
                    <div class="close-button-container">
                        <button mat-button (click)="selectRef.close()" class="close-button">
                          Close
                        </button>
                    </div>
                <!-- </mat-option> -->
            </mat-select>
        </mat-form-field>
      

        <div class="spendings-history--calendar">
            <a href="spending/calendar" class="calendar-btn">
                <p style="margin: 0">Calendar</p>
                <mat-icon>calendar_month</mat-icon>
            </a>
        </div>
    </section>

    <div class="spendings-history--list">

        <p class="spendings-history--list-item">Today</p>
        @for (spendingToday of categoriesSpendings.today; track spendingToday.id) {
            <pgz-history-spending-card [spending]="spendingToday"></pgz-history-spending-card>
        }

        <p class="spendings-history--list-item">Last week</p>
        @for (spendingLastWeek of categoriesSpendings.lastWeek; track spendingLastWeek.id) {
            <pgz-history-spending-card [spending]="spendingLastWeek"></pgz-history-spending-card>
        }

        <p class="spendings-history--list-item">Last month</p>
        @for (spendingLastMonth of categoriesSpendings.month; track spendingLastMonth.id) {
            <pgz-history-spending-card [spending]="spendingLastMonth"></pgz-history-spending-card>
        }

    </div>
</section>
